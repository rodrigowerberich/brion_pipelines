<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASML Brion Software case: pipelines: Parsing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ASML Brion Software case: pipelines<span id="projectnumber">&#160;v2.0</span>
   </div>
   <div id="projectbrief">Organize pipeline logs by gathering logs from the same pipeline, decoding them and putting them in order</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('Parsing.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Parsing</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Parsing is divided into two parts:</p><ul>
<li>Structure<ul>
<li><a class="el" href="structure_8h.html" title="Parses a stream of data into a structured log message format.">structure.h</a></li>
<li><a class="el" href="structure_8cc.html" title="Implementation of the structured log message parser. This file contains the implementation of the str...">structure.cc</a></li>
</ul>
</li>
<li>Semantics<ul>
<li><a class="el" href="semantics_8h.html" title="Defines core classes and types for log message parsing semantics.">semantics.h</a></li>
<li><a class="el" href="semantics_8cc.html" title="Implementation of the Parser class and related functionality.">semantics.cc</a></li>
<li><a class="el" href="ascii__body__parser_8h.html" title="This file defines the AsciiBodyParser class, which is responsible for parsing ASCII-encoded log messa...">ascii_body_parser.h</a></li>
<li><a class="el" href="ascii__body__parser_8cc.html" title="Implementation of the AsciiBodyParser class.">ascii_body_parser.cc</a></li>
<li><a class="el" href="hex16__body__parser_8h.html" title="Defines the Hex16BodyParser class for parsing hexadecimal 16-bit body messages.">hex16_body_parser.h</a></li>
<li><a class="el" href="hex16__body__parser_8cc.html" title="Implementation of the Hex16BodyParser class.">hex16_body_parser.cc</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Structure Parsing</h1>
<p>The structure parsing goes over the file and tries to identify the Pipeline Log Messages. Its output is a list of log messages with the 5 fields:</p>
<ul>
<li>Pipeline ID</li>
<li>ID</li>
<li>Encoding</li>
<li>Body</li>
<li>Next ID</li>
</ul>
<p>and a list of the errors found during parsing. These fields are just a blob of data at this point and don't represent anything.</p>
<p>The current algorithm used to identify the fields are:</p>
<p>1) Skip all whitespace until a non-whitespace is found</p>
<p>2) Read all data until a whitespace, this is our pipeline ID.</p>
<p>3) Skip all whitespace</p>
<p>4) Read all data until a whitespace, this is our ID</p>
<p>5) Skip all whitespace</p>
<p>6) Read all data until a whitespace, this is our encoding</p>
<p>7) Read all whitespace</p>
<p>8) If we found an open bracket, continue, otherwise throw a parsing error</p>
<p>9) Read all characters until you find a close bracket, followed by whitespace, followed by a continuous string without close bracket, followed by a new line. If the file ends before that, throw a parsing error. Otherwise, the body is the content between the open brackets and the last close bracket. And the next id is the continuous string after that close bracket.</p>
<p>Advantages of this algorithm:</p><ul>
<li>If there is no ill form related to the body, it allows open brackets "[" and close bracket "]" to be freely used inside the body and can parse correctly</li>
</ul>
<p>Disadvantages of this algorithm</p><ul>
<li>If there is an ill form, the next valid message will be added to the body of this message, or if there are other brackets in that body it can lead to even more messages being dropped.</li>
<li>Closing brackets can not be used as ids, as they will cause problem in the parsing.</li>
</ul>
<p>Ideally the ascii body should have character scaping for the brackets, this way this could be avoid.</p>
<p>Another options that was considered was to use regexes, but they are a bit slower and this parser does not take much too write. (It also allow me to show a bit more for this coding exercise)</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Semantics parsing</h1>
<p>For the semantics parsing there is not much to do, all the fields except the body and the encoding don't really have any semantic meaning and any value is allowed there.</p>
<p>In the future in case there was some id form we would like to reject it could be added here.</p>
<p>For extensibility the semantics parser allows body parsers to be registered under different encoding codes. These encoding codes are any continous string, but for this application we only use 0 or 1.</p>
<p>The semantics parser then checks if the encoding code is one of the registereds one, and then call the appropriated body parser. If no encoding is found, a parsing error is added to the list of errors and that message is ignored.</p>
<p>The body parsers can also throw parsing errors, which are added to the list of errors. If a body parser throws an error, that message will be ignored and not processed.</p>
<p>The hex parser cleans up any whitespace inside the body, checks the number of characters is even, and that the characters are valid hex numbers. It then transforms then into ascii characters.</p>
<p>The ascii parser currently does nothing. But it could in theory clean up escaped characters. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
